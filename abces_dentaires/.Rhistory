select(molecule_filled, is_antibiotic, duration) %>%
mutate(molecule_filled = str_squish(molecule_filled), is_antibiotic = str_squish(is_antibiotic)) %>%
rename(Molecule = molecule_filled, Atb = is_antibiotic) %>%
filter(str_detect(Atb, "True|TRUE")) %>%
mutate(
Molecule =
str_replace(
Molecule,
"(?i).*(amoxicilline.*clavulanique|clavulanique.*amoxicilline).*", "Augmentin"
),
Molecule =
str_replace(
Molecule,
"(?i).*(metronidazole.*spiramycine|spyramicine.*metronidazole).*", "Metronidazole+Spyramicine"
),
Molecule =
str_replace(
Molecule,
"(?i).*(clindamycine).*", "Clindamycine"
),
Molecule = str_to_title(Molecule)
) %>%
count(Molecule) %>%
mutate("%" = round(n/2174 * 100, 2)) %>%
arrange(desc(n)) %>%
kable(caption = "Frequency of antibiotics prescription by consultation") %>%
kable_minimal()
str_count(qare$is_antibiotic, "TRUE|True|true") %>%
table() %>%
data.frame() %>%
mutate("%" = round(prop.table(Freq) * 100, 2)) %>%
kable(col.names = c("Antibiotics prescribed", "n", "%"), caption = "Nb of antibiotics prescribed during a consultation") %>%
kable_minimal()
table(str_detect(qare$molecule_filled, ".*fene\\b"), useNA = "ifany") %>%
data.frame() %>%
mutate("%" = round(proportions(Freq) * 100, 2)) %>%
kable(col.names = c("", "n", "%"), caption = "Has anti-inflammatory") %>%
kable_minimal()
str_detect(qare$imagery_category, "(?i)radio") %>%
table(useNA = "ifany") %>%
data.frame() %>%
mutate("%" = round(proportions(Freq) * 100, 2)) %>%
kable(col.names = c("", "n", "%"), caption = "Rx precribed?") %>%
kable_minimal()
# age des patients
# sexe des patients
# départements
# age des prats
# sexe des prats
# catégorie de pathologie (carie, abcès/périodontite ou autre)
# spécialité (med gé ou dentiste)
# durée de la TC
qare <- qare %>%
mutate(
patient_age_range = factor(patient_age_range,
labels = c(
"0-20", "0-20",
"21-60", "21-60", "21-60", "21-60",
"61-100", "61-100", "61-100", "61-100"
)
),
physician_age_range = factor(physician_age_range,
labels = c(
"21-60", "21-60", "21-60", "21-60",
"61-100", "61-100"
)
)
)
qare$patient_age_range
qare$patient_age_range %>% levels()
qare$patient_age_range %>% factor
qare$physician_age_range %>% factor
# age des patients
# sexe des patients
# départements
# age des prats
# sexe des prats
# catégorie de pathologie (carie, abcès/périodontite ou autre)
# spécialité (med gé ou dentiste)
# durée de la TC
qare <- qare %>%
mutate(
patient_age_range = factor(patient_age_range,
labels = c(
"0-20", "0-20",
"21-60", "21-60", "21-60", "21-60",
"61-100", "61-100"
)
),
physician_age_range = factor(physician_age_range,
labels = c(
"21-60", "21-60", "21-60", "21-60",
"61-100", "61-100"
)
)
)
qare <- qare %>%
mutate(cim10 = case_when(
str_detect(cim10, "Abcès|périodontite") ~ "Abcès/périodontite",
str_detect(cim10, "Carie") ~ "Carie",
TRUE ~ "Autre"
))
mod1 <- glm(data = qare, has_antibiotic ~ patient_age_range)
mod2 <- glm(data = qare, has_antibiotic ~ patient_gender)
mod3 <- glm(data = qare, has_antibiotic ~ physician_gender)
mod4 <- glm(data = qare, has_antibiotic ~ physician_age_range)
mod5 <- glm(data = qare, has_antibiotic ~ cim10)
mod6 <- glm(
data = qare, has_antibiotic ~ speciality,
subset = (str_detect(qare$speciality, "dentist|general-practician"))
)
rbind(
summary(mod1)$coefficients,
summary(mod2)$coefficients,
summary(mod3)$coefficients,
summary(mod4)$coefficients,
summary(mod5)$coefficients,
summary(mod6)$coefficients
) %>%
as.data.frame() %>%
slice(-1, -4, -6, -8, -10, -13) %>%
mutate(`Pr(>|t|)` = pval_format(`Pr(>|t|)`)) %>%
kable(
col.names = c("Estimate", "Std error", "t-value", "P-value"),
caption = "Univariate models"
) %>%
kable_minimal() %>%
row_spec(c(1, 2, 4, 6, 7, 8), bold = T)
tab1 <- cbind(round(exp(confint(mod1)), 2),
"OR" = round(exp(coef(mod1)), 2),
"p-value" = round(coef(summary(mod1))[, "Pr(>|t|)"], 5)
)
tab2 <- cbind(round(exp(confint(mod2)), 2),
"OR" = round(exp(coef(mod2)), 2),
"p-value" = round(coef(summary(mod2))[, "Pr(>|t|)"], 5)
)
tab3 <- cbind(round(exp(confint(mod3)), 2),
"OR" = round(exp(coef(mod3)), 2),
"p-value" = round(coef(summary(mod3))[, "Pr(>|t|)"], 5)
)
tab4 <- cbind(round(exp(confint(mod4)), 2),
"OR" = round(exp(coef(mod4)), 2),
"p-value" = round(coef(summary(mod4))[, "Pr(>|t|)"], 5)
)
tab5 <- cbind(round(exp(confint(mod5)), 2),
"OR" = round(exp(coef(mod5)), 2),
"p-value" = round(coef(summary(mod5))[, "Pr(>|t|)"], 5)
)
tab6 <- cbind(round(exp(confint(mod6)), 2),
"OR" = round(exp(coef(mod6)), 2),
"p-value" = round(coef(summary(mod6))[, "Pr(>|t|)"], 5)
)
rbind(tab1, tab2, tab3, tab4, tab5, tab6) %>%
as.data.frame() %>%
slice(-1, -4, -6, -8, -10, -13) %>%
mutate("p-value" = pval_format(`p-value`)) %>%
`rownames<-`(c(
"Patient - age 21-60", "Patient - age 61-100",
"Patient - Male", "Physician - Male", "Physician - age 61-100",
"CIM10 - Miscellanea", "CIM10 - Carie", "General practician"
)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value"), caption = "Univariate results") %>%
kable_minimal() %>%
row_spec(c(1, 2, 4, 5, 6, 7, 8), bold = T)
rbind(tab1, tab2, tab3, tab4, tab5, tab6) %>%
as.data.frame() %>%
slice(-1, -4, -6, -8, -10, -13) %>%
mutate("p-value" = pval_format(`p-value`)) %>%
`rownames<-`(c(
"Patient - age 21-60", "Patient - age 61-100",
"Patient - Male", "Physician - Male", "Physician - age 61-100",
"CIM10 - Miscellanea", "CIM10 - Carie", "General practician"
)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value"), caption = "Univariate results") %>%
kable_minimal() %>%
row_spec(c(4, 6, 7, 8), bold = T)
lab <- c(
"General practician", "Patient - Male", "Patient - age 21-60",
"Patient - age 61-100", "Physician - Male", "Physician - age 61-100",
"CIM10 - Miscellanea", "CIM10 - Carie"
)
mod <- glm(
data = qare, has_antibiotic ~ speciality + patient_gender + patient_age_range + physician_gender + physician_age_range + cim10,
subset = (str_detect(qare$speciality, "dentist|general-practician"))
)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(3, 4, 7, 8), bold = T)
lab <- c(
"General practician", "Patient - Male",  "Physician - Male", "Physician - age 61-100",
"CIM10 - Miscellanea", "CIM10 - Carie"
)
mod <- glm(
data = qare, has_antibiotic ~ speciality + patient_gender + physician_gender + physician_age_range + cim10,
subset = (str_detect(qare$speciality, "dentist|general-practician"))
)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(3, 4, 7, 8), bold = T)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(3, 4,), bold = T)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal()
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(5, 6), bold = T)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(5, 4), bold = T)
mod <- glm(
data = qare, has_antibiotic ~ speciality + physician_gender + physician_age_range + cim10,
subset = (str_detect(qare$speciality, "dentist|general-practician"))
)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(5, 6), bold = T)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(5), bold = T)
lab <- c(
"General practician", "Physician - Male", "Physician - age 61-100",
"CIM10 - Miscellanea", "CIM10 - Carie",""
)
mod <- glm(
data = qare, has_antibiotic ~ speciality + physician_gender + physician_age_range + cim10,
subset = (str_detect(qare$speciality, "dentist|general-practician"))
)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(5), bold = T)
lab <- c(
"General practician", "Physician - Male", "Physician - age 61-100",
"CIM10 - Miscellanea", "CIM10 - Carie"
)
mod <- glm(
data = qare, has_antibiotic ~ speciality + physician_gender + physician_age_range + cim10,
subset = (str_detect(qare$speciality, "dentist|general-practician"))
)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(5), bold = T)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(4,5), bold = T)
lab <- c(
"General practician", "Physician - Male", "CIM10 - Miscellanea", "CIM10 - Carie"
)
mod <- glm(
data = qare, has_antibiotic ~ speciality + physician_gender + cim10,
subset = (str_detect(qare$speciality, "dentist|general-practician"))
)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(4,5), bold = T)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
data.frame() %>%
slice(-1) %>%
`rownames<-`(lab) %>%
mutate("p.value" = pval_format(p.value)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value")) %>%
kable_minimal() %>%
row_spec(c(4,3), bold = T)
rbind(tab1, tab2, tab3, tab4, tab5, tab6) %>%
as.data.frame() %>%
slice(-1, -4, -6, -8, -10, -13) %>%
mutate("p-value" = pval_format(`p-value`)) %>%
`rownames<-`(c(
"Patient - age 21-60", "Patient - age 61-100",
"Patient - Male", "Physician - Male", "Physician - age 61-100",
"CIM10 - Miscellanea", "CIM10 - Carie", "General practician"
)) %>%
kable(col.names = c("2.5%", "97.5%", "OR", "p-value"), caption = "Univariate results") %>%
kable_minimal() %>%
row_spec(c(4, 6, 7, 8), bold = T)
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
as.data.frame() %>%
mutate(
"p-value" = pval_format(`p-value`),
id = as.double(1:9)
) %>%
rename(
"min" = "2.5 %",
"max" = "97.5 %"
) %>%
slice(-1) %>%
ggplot(aes(y = id, x = OR)) +
geom_point() +
scale_y_continuous(name = "", breaks = 2:9, labels = lab) +
geom_errorbarh(aes(xmin = min, xmax = max), height = .1) +
labs() +
geom_vline(xintercept = 1, linetype = 2) +
theme_classic() +
scale_x_continuous(breaks = seq(0, 3, 0.1))
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
as.data.frame() %>%
mutate(
"p-value" = pval_format(`p-value`),
id = as.double(1:5)
) %>%
rename(
"min" = "2.5 %",
"max" = "97.5 %"
) %>%
slice(-1) %>%
ggplot(aes(y = id, x = OR)) +
geom_point() +
scale_y_continuous(name = "", breaks = 2:9, labels = lab) +
geom_errorbarh(aes(xmin = min, xmax = max), height = .1) +
labs() +
geom_vline(xintercept = 1, linetype = 2) +
theme_classic() +
scale_x_continuous(breaks = seq(0, 3, 0.1))
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
as.data.frame() %>%
mutate(
"p-value" = pval_format(`p-value`),
id = as.double(1:5)
) %>%
rename(
"min" = "2.5 %",
"max" = "97.5 %"
) %>%
slice(-1) %>%
ggplot(aes(y = id, x = OR)) +
geom_point() +
scale_y_continuous(name = "", breaks = 2:5, labels = lab) +
geom_errorbarh(aes(xmin = min, xmax = max), height = .1) +
labs() +
geom_vline(xintercept = 1, linetype = 2) +
theme_classic() +
scale_x_continuous(breaks = seq(0, 3, 0.1))
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
as.data.frame() %>%
mutate(
"p-value" = pval_format(`p-value`),
id = as.double(1:5)
) %>%
rename(
"min" = "2.5 %",
"max" = "97.5 %"
) %>%
slice(-1) %>%
ggplot(aes(y = id, x = OR)) +
geom_point() +
scale_y_continuous(name = "", breaks = 1:5, labels = lab) +
geom_errorbarh(aes(xmin = min, xmax = max), height = .1) +
labs() +
geom_vline(xintercept = 1, linetype = 2) +
theme_classic() +
scale_x_continuous(breaks = seq(0, 3, 0.1))
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
as.data.frame() %>%
mutate(
"p-value" = pval_format(`p-value`),
id = as.double(1:5)
) %>%
rename(
"min" = "2.5 %",
"max" = "97.5 %"
) %>%
slice(-1) %>%
ggplot(aes(y = id, x = OR)) +
geom_point() +
scale_y_continuous(name = "", breaks = 2:6, labels = lab) +
geom_errorbarh(aes(xmin = min, xmax = max), height = .1) +
labs() +
geom_vline(xintercept = 1, linetype = 2) +
theme_classic() +
scale_x_continuous(breaks = seq(0, 3, 0.1))
cbind(round(exp(confint(mod)), 2),
"OR" = round(exp(coef(mod)), 2),
"p-value" = round(coef(summary(mod))[, "Pr(>|t|)"], 5)
) %>%
as.data.frame() %>%
mutate(
"p-value" = pval_format(`p-value`),
id = as.double(1:5)
) %>%
rename(
"min" = "2.5 %",
"max" = "97.5 %"
) %>%
slice(-1) %>%
ggplot(aes(y = id, x = OR)) +
geom_point() +
scale_y_continuous(name = "", breaks = 2:5, labels = lab) +
geom_errorbarh(aes(xmin = min, xmax = max), height = .1) +
labs() +
geom_vline(xintercept = 1, linetype = 2) +
theme_classic() +
scale_x_continuous(breaks = seq(0, 3, 0.1))
qare$ticked_cardio_vascular %>%
table() %>%
data.frame() %>%
mutate("%" = round(proportions(Freq) * 100, 2)) %>%
kable(col.names = c("", "n", "%"), caption = "ATCD cardiovasculaires oui/non") %>%
kable_minimal()
